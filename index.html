<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tomorrow Planner</title>
  <!-- Modern font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Firebase (compat) SDKs: Auth + Firestore -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="page-bubble">
    <div class="app-shell">
      <header>
        <div class="header-left">
          <h1>Tomorrow Planner</h1>
        </div>
        <div class="header-right">
          <div class="date-display" id="header-date"></div>
          <div class="header-actions">
            <button type="button" id="zen-toggle-btn" class="zen-btn">üßò Zen</button>
            <button type="button" id="print-summary-btn" class="print-btn">üñ® Print</button>
          </div>
        </div>
      </header>

      <!-- Auth bar -->
      <div class="auth-bar" id="auth-bar">
        <div id="auth-logged-out">
          <span>Cloud sync:</span>
          <input type="email" id="auth-email" placeholder="Email" />
          <input type="password" id="auth-password" placeholder="Password" />
          <button type="button" id="auth-login-btn">Log in</button>
          <div class="auth-secondary">
            <button type="button" id="auth-register-btn" class="auth-link-button">
              Create a new account
            </button>
          </div>
        </div>
        <div id="auth-logged-in" style="display:none;">
          <span class="auth-status" id="auth-user-label"></span>
          <button type="button" id="auth-logout-btn">Log out</button>
        </div>
      </div>
      <div class="hint-text" id="auth-hint">
        Log in to sync your planner to the cloud. If you stay logged out, everything is saved only on this device.
      </div>

      <!-- Top row: goals as bubbles + new goal form + AI goal generator -->
      <div class="card card-top">
        <div class="goals-row-wrapper">
          <div class="goals-row-header">
            <h2>üéØ Pick what Future You wants to do</h2>
            <span class="column-subtitle">Click or drag bubbles into ‚ÄúTomorrow‚Äôs Plan‚Äù ¬∑ Edit or delete any bubble</span>
          </div>
          <div class="goals-row" id="goals-row"></div>

          <form class="new-goal-form" id="new-goal-form">
            <input
              type="text"
              id="new-goal-name"
              placeholder="New tomorrow goal (e.g. Meal prep, Study cardio)"
              required
            />
            <input
              type="text"
              id="new-goal-tasks"
              placeholder="What needs to happen today? (comma-separated tasks)"
              required
            />
            <button type="submit">Add goal</button>
          </form>
          <div class="hint-text">
            Tasks like ‚ÄúLay out clothes, Charge headphones, Check gym hours‚Äù will be split into separate checklist items.
          </div>

          <div class="ai-goal-section">
            <div class="ai-goal-label">AI goal helper (optional)</div>
            <div class="ai-goal-row">
              <input type="text" id="ai-goal-prompt" placeholder="Describe what Future You wants to do (e.g. run 5K, big leg day, clean garage, study boards)" />
              <button type="button" id="ai-goal-generate-btn">‚ú® Create goal</button>
            </div>
            <div class="hint-text">
              The bubble name will be exactly what you type. The helper suggests a checklist for today based on your description.
            </div>
          </div>
        </div>
      </div>

      <!-- Main area: tomorrow plan + today checklist -->
      <div class="main-columns">
        <div class="card card-plan">
          <div class="column-header">
            <div>
              <h2>üåÖ Tomorrow‚Äôs Plan</h2>
              <div class="column-subtitle">Goals you‚Äôve committed to for the next day</div>
            </div>
          </div>
          <div id="tomorrow-plan" class="droptarget"></div>
          <div class="hint-text">
            Drag a bubble here, or click a bubble to toggle it on/off.
          </div>
        </div>

        <div class="card card-checklist">
          <div class="column-header">
            <div>
              <h2>‚úÖ Today‚Äôs Checklist</h2>
              <div class="column-subtitle">Prerequisites for your tomorrow goals + extra one-off tasks</div>
            </div>
          </div>

          <!-- Completion meter -->
          <div class="completion-row">
            <div class="completion-label"><strong id="completion-perc">0%</strong> done</div>
            <div class="completion-bar">
              <div class="completion-bar-fill" id="completion-bar-fill"></div>
            </div>
          </div>

          <div id="checklist"></div>

          <!-- Add extra checklist bullet without making a new goal -->
          <form class="add-task-inline" id="new-checklist-task-form">
            <input
              type="text"
              id="new-checklist-task"
              placeholder="Add a one-off task just for today"
            />
            <button type="submit">Add task</button>
          </form>
        </div>
      </div>

      <!-- Footer: tabbed -->
      <footer>
        <div class="tabs">
          <div class="tab-buttons">
            <button type="button" class="tab-btn active" data-tab="day">üìÖ Day & Notes</button>
            <button type="button" class="tab-btn" data-tab="health">üí™ Health</button>
            <button type="button" class="tab-btn" data-tab="settings">‚öôÔ∏è Settings</button>
          </div>

          <!-- Day & Notes tab -->
          <div class="tab-content active" data-tab="day">
            <div class="card card-footer-nav">
              <h3 class="card-section-title">üìÜ Day navigation & checklist summary</h3>
              <div class="calendar-row">
                <div class="date-nav">
                  <button type="button" id="prev-day-btn">‚óÄ Prev day</button>
                  <span class="date-nav-current" id="current-day-label"></span>
                  <button type="button" id="next-day-btn">Next day ‚ñ∂</button>
                </div>

                <div class="stats" id="task-stats"></div>

                <button type="button" class="carry-forward-btn" id="carry-forward-btn">
                  Carry incomplete tasks to next day
                </button>
              </div>
              <div class="hint-text">
                Use the arrows to review other days. Carry forward will copy any unchecked tasks (including one-off ones) into the next day‚Äôs checklist.
              </div>
            </div>

            <div class="card card-footer-notes">
              <h3 class="card-section-title">üìù Daily notes</h3>
              <textarea id="daily-notes" placeholder="Jot down anything about this day..."></textarea>
            </div>

            <div class="card card-footer-upcoming">
              <h3 class="card-section-title">üìå Upcoming scheduled tasks</h3>
              <div id="upcoming-list"></div>
            </div>
          </div>

          <!-- Health tab -->
          <div class="tab-content" data-tab="health">
            <div class="card card-footer-health">
              <h3 class="card-section-title">üí™ Exercise & üçΩ Diet overview</h3>

              <div class="health-row">
                <div class="health-section" id="exercise-section">
                  <h3>Exercise</h3>
                  <div class="health-fields">
                    <label>Exercise details:</label>
                    <textarea id="exercise-notes" placeholder="What did you do? Sets, reps, distance, etc."></textarea>
                    <label class="rating-label">
                      Exercise rating:
                      <input type="range" id="exercise-rating" min="1" max="10">
                      <span id="exercise-rating-value">-</span>
                    </label>
                    <div class="activity-hint" id="exercise-activity-label"></div>
                  </div>
                  <div class="profile-fields">
                    <div class="profile-row">
                      <input type="number" id="profile-weight" placeholder="Weight (lb)">
                      <input type="number" id="profile-height" placeholder="Height (in)">
                    </div>
                    <div class="profile-row">
                      <input type="number" id="profile-age" placeholder="Age (years)">
                      <select id="profile-sex">
                        <option value="">Sex</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                      </select>
                    </div>
                    <div class="hint-text" id="bmr-display">BMR: basic ‚Äì ¬∑ adjusted ‚Äì</div>
                  </div>
                </div>

                <div class="health-section" id="diet-section">
                  <h3>Diet & calories</h3>
                  <div class="health-fields">
                    <label>
                      Target calories:
                      <input type="number" id="diet-target" min="0" step="10" placeholder="e.g. 2200">
                    </label>
                    <label>
                      Calories consumed:
                      <input type="number" id="diet-consumed" min="0" step="10">
                    </label>
                    <label class="rating-label">
                      Food day rating:
                      <input type="range" id="diet-rating" min="1" max="10">
                      <span id="diet-rating-value">-</span>
                    </label>
                    <div class="activity-hint" id="diet-quality-label"></div>
                    <div class="hint-text" id="diet-delta-display">Today‚Äôs calories: ‚Äì (set target & consumed)</div>
                  </div>
                </div>
              </div>

              <div class="health-summary">
                <div class="mini-cal-header">
                  <div class="mini-cal-range-label">Past 4 weeks</div>
                  <div class="mini-cal-nav">
                    <button type="button" id="mini-cal-today-btn">Today</button>
                    <button type="button" id="mini-cal-prev-month-btn">‚óÄ</button>
                    <span id="mini-cal-month-label"></span>
                    <button type="button" id="mini-cal-next-month-btn">‚ñ∂</button>
                  </div>
                </div>
                <div class="mini-calendars">
                  <div class="mini-calendar">
                    <div class="mini-calendar-title">Exercise</div>
                    <div class="mini-calendar-grid" id="exercise-mini-calendar"></div>
                  </div>
                  <div class="mini-calendar">
                    <div class="mini-calendar-title">Food</div>
                    <div class="mini-calendar-grid" id="diet-mini-calendar"></div>
                  </div>
                </div>
                <div class="projection">
                  <div class="projection-row" id="calorie-summary"></div>
                  <div class="projection-row" id="weight-projection"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Settings tab -->
          <div class="tab-content" data-tab="settings">
            <div class="card card-footer-theme">
              <h3 class="card-section-title">üé® Themes & backup</h3>
              <div class="theme-selector">
                <label>Color theme:</label>
                <button type="button" class="theme-button" data-theme="calm">Calm</button>
                <button type="button" class="theme-button" data-theme="pastel-sunrise">Pastel sunrise</button>
                <button type="button" class="theme-button" data-theme="pastel-lilac">Pastel lilac</button>
                <button type="button" class="theme-button" data-theme="pastel-mint">Pastel mint</button>
                <button type="button" class="theme-button" data-theme="pastel-rainbow">Pastel rainbow</button>
                <button type="button" class="theme-button" data-theme="warm-sand">Warm sand</button>
                <button type="button" class="theme-button" data-theme="wood-journal">Wood / journal</button>
                <button type="button" class="theme-button" data-theme="hot-pink">Hot pink</button>
                <button type="button" class="theme-button" data-theme="night-moon">Night moon</button>
                <button type="button" class="theme-button" data-theme="night-matrix">Night matrix</button>
                <button type="button" class="theme-button" data-theme="night-tron">Night TRON</button>
              </div>

              <div class="save-controls">
                <span>Backup:</span>
                <button type="button" id="save-state-btn">Save backup file</button>
                <label for="load-state-input">
                  Load backup
                  <input type="file" id="load-state-input" accept="application/json" />
                </label>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>

  <!-- Hidden print summary container -->
  <div class="print-summary" id="print-summary"></div>

  
  <script src="script.js"></script>
</body>
</html>
